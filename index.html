<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>UPI Payment Admin Dashboard</title>
  <style>
    :root{
      --bg:#0b1020; --card:#121832; --muted:#7e8bb6; --text:#e7ecff; --accent:#7aa2ff; --accent-2:#4ade80; --danger:#ef4444;
    }
    *{box-sizing:border-box}
    body{margin:0; font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif; background:linear-gradient(180deg,#0b1020,#0b1226); color:var(--text)}
    .container{max-width:1100px; margin:32px auto; padding:0 16px}
    header{display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:20px}
    h1{font-size:24px; margin:0; letter-spacing:.3px}
    .tabs{display:flex; gap:8px; flex-wrap:wrap}
    .tab{padding:10px 14px; border-radius:999px; border:1px solid #2b3566; cursor:pointer; color:var(--muted); background:#0e1430}
    .tab.active{background:var(--accent); color:#051026; border-color:transparent}
    .card{background:var(--card); border:1px solid #1b2450; border-radius:18px; padding:18px; box-shadow:0 10px 30px rgba(0,0,0,.3)}
    .grid{display:grid; gap:14px}
    .grid-2{grid-template-columns:repeat(2,minmax(0,1fr))}
    @media (max-width:840px){.grid-2{grid-template-columns:1fr}}
    label{display:block; font-size:12px; color:var(--muted); margin:4px 2px}
    input, textarea, select{width:100%; background:#0e1430; color:var(--text); border:1px solid #2b3566; border-radius:12px; padding:12px 12px; outline:none}
    input:focus, textarea:focus{border-color:var(--accent)}
    .row{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    .btn{appearance:none; border:1px solid #2b3566; background:#0f1536; color:var(--text); padding:10px 14px; border-radius:12px; cursor:pointer}
    .btn.primary{background:var(--accent); border-color:transparent; color:#07122a; font-weight:600}
    .btn.success{background:var(--accent-2); border-color:transparent; color:#041312; font-weight:600}
    .btn.ghost{background:transparent}
    .btn.danger{background:var(--danger); border-color:transparent}
    .muted{color:var(--muted)}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
    .code{background:#0e1430; border:1px dashed #2b3566; padding:10px; border-radius:12px; word-break:break-all}
    .divider{height:1px; background:#1b2450; margin:14px 0}
    .tag{display:inline-flex; align-items:center; gap:6px; font-size:12px; padding:6px 10px; border:1px solid #2b3566; border-radius:999px; color:var(--muted)}
    .right{margin-left:auto}
    .hidden{display:none !important}
    footer{margin-top:22px; color:var(--muted); font-size:12px}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>UPI Payment Admin Dashboard <span class="tag"><span>no backend</span></span></h1>
      <div class="tabs">
        <button id="tab-admin" class="tab active" onclick="switchTab('admin')">Admin</button>
        <button id="tab-generate" class="tab" onclick="switchTab('generate')">Generate Link</button>
        <button id="tab-customer" class="tab" onclick="switchTab('customer')">Preview Payment Page</button>
      </div>
    </header>

    <!-- ADMIN SETTINGS -->
    <section id="page-admin" class="card">
      <h2 style="margin:4px 0 10px 0">Business / UPI Settings</h2>
      <div class="grid grid-2">
        <div>
          <label>UPI ID (pa)</label>
          <input id="inp-upi" placeholder="yourname@bank or 98xxxxxx@ybl" autocomplete="off" />
        </div>
        <div>
          <label>Business / Payee Name (pn)</label>
          <input id="inp-name" placeholder="Your Business" autocomplete="off" />
        </div>
        <div>
          <label>Default Note (tn) <span class="muted">optional</span></label>
          <input id="inp-note" placeholder="e.g., Invoice / Order note" />
        </div>
        <div>
          <label>Default Currency (cu)</label>
          <select id="inp-currency">
            <option value="INR" selected>INR</option>
          </select>
        </div>
      </div>
      <div class="row" style="margin-top:14px">
        <button class="btn primary" onclick="saveSettings()">Save Settings</button>
        <button class="btn ghost" onclick="loadSettings()">Reload</button>
        <button class="btn danger" onclick="clearSettings()">Clear</button>
        <span class="muted right" id="settings-status"></span>
      </div>
      <div class="divider"></div>
      <p class="muted">These values are stored only in your browser using <span class="mono">localStorage</span>. No server required.</p>
    </section>

    <!-- GENERATE LINK -->
    <section id="page-generate" class="card hidden">
      <h2 style="margin:4px 0 10px 0">Generate Payment Link</h2>
      <div class="grid grid-2">
        <div>
          <label>Customer Name</label>
          <input id="inp-customer" placeholder="Customer full name" />
        </div>
        <div>
          <label>Amount (INR)</label>
          <input id="inp-amount" type="number" step="0.01" min="1" placeholder="500" />
        </div>
        <div>
          <label>Reference / Order ID (tr) <span class="muted">optional</span></label>
          <input id="inp-ref" placeholder="e.g., ORD-1042" />
        </div>
        <div>
          <label>Custom Note (tn) <span class="muted">optional overrides default</span></label>
          <input id="inp-custom-note" placeholder="e.g., Rahul - June subscription" />
        </div>
      </div>
      <div class="row" style="margin-top:14px">
        <button class="btn primary" onclick="makeLinks()">Generate</button>
        <span class="muted right" id="gen-status"></span>
      </div>

      <div id="results" class="hidden" style="margin-top:16px">
        <div class="row" style="justify-content:space-between">
          <div class="tag">Direct UPI Deep Link</div>
          <div class="row">
            <button class="btn" onclick="copy('#out-upi')">Copy</button>
            <a class="btn success" id="btn-open-upi">Open</a>
          </div>
        </div>
        <div id="out-upi" class="code mono" style="margin-top:8px"></div>

        <div class="row" style="justify-content:space-between; margin-top:16px">
          <div class="tag">Shareable Payment Page Link</div>
          <div class="row">
            <button class="btn" onclick="copy('#out-web')">Copy</button>
            <a class="btn" id="btn-open-web" target="_blank">Open</a>
          </div>
        </div>
        <div id="out-web" class="code mono" style="margin-top:8px"></div>
      </div>

      <div class="divider"></div>
      <details>
        <summary class="muted">What do these links do?</summary>
        <p class="muted">The <b>UPI deep link</b> opens installed UPI apps directly using the standard format <span class="mono">upi://pay?... </span>. The <b>Payment Page link</b> points to this same HTML file with query parameters; when your customer opens it, the page shows a simple "Pay Now" button that triggers the deep link.</p>
      </details>
    </section>

    <!-- CUSTOMER PAGE (PREVIEW) -->
    <section id="page-customer" class="card hidden">
      <h2 style="margin:4px 0 10px 0">Customer Payment Page</h2>
      <p class="muted">This is what customers see when you share the Payment Page link.</p>
      <div id="cust-box" class="card" style="background:#0c1330; border-style:dashed">
        <div class="grid grid-2">
          <div>
            <div class="muted">Payee</div>
            <div id="cust-pn" style="font-weight:600; font-size:18px">—</div>
            <div class="muted">UPI ID</div>
            <div id="cust-pa" class="mono">—</div>
          </div>
          <div>
            <div class="muted">Customer</div>
            <div id="cust-name" style="font-weight:600; font-size:18px">—</div>
            <div class="muted">Amount</div>
            <div id="cust-amt" style="font-weight:700; font-size:24px">—</div>
          </div>
        </div>
        <div style="margin-top:12px">
          <div class="muted">Note</div>
          <div id="cust-tn">—</div>
          <div class="muted" style="margin-top:8px">Reference</div>
          <div id="cust-tr" class="mono">—</div>
        </div>
        <div class="row" style="margin-top:16px">
          <a id="cust-pay" class="btn success" href="#">Pay Now</a>
          <button class="btn" onclick="copy('#cust-upi-link')">Copy UPI Link</button>
          <div id="cust-upi-link" class="hidden"></div>
        </div>
      </div>
    </section>

    <footer>
      <div class="row">
        <span>Made for quick UPI requests • Works offline • Save this file and host anywhere.</span>
        <span class="right muted">Tip: Add to mobile home screen for faster access.</span>
      </div>
    </footer>
  </div>

<script>
  const LS_KEY = 'upi-dashboard-settings-v1';

  function $(sel){return document.querySelector(sel)}
  function enc(v){return encodeURIComponent(v || '')}
  function dec(v){try{return decodeURIComponent(v||'')}catch{ return v||''}}

  function switchTab(key){
    const map = {admin:'#page-admin', generate:'#page-generate', customer:'#page-customer'};
    for(const k in map){
      const el = $(map[k]);
      const tab = $('#tab-'+k);
      if(k===key){ el.classList.remove('hidden'); tab.classList.add('active'); }
      else{ el.classList.add('hidden'); tab.classList.remove('active'); }
    }
  }

  function loadSettings(){
    const raw = localStorage.getItem(LS_KEY);
    if(!raw){ $('#settings-status').textContent = 'No saved settings yet.'; return }
    try{
      const s = JSON.parse(raw);
      $('#inp-upi').value = s.pa || '';
      $('#inp-name').value = s.pn || '';
      $('#inp-note').value = s.tn || '';
      $('#inp-currency').value = s.cu || 'INR';
      $('#settings-status').textContent = 'Loaded saved settings.';
    }catch(e){ $('#settings-status').textContent = 'Could not parse saved settings.' }
  }

  function saveSettings(){
    const pa = $('#inp-upi').value.trim();
    const pn = $('#inp-name').value.trim();
    const tn = $('#inp-note').value.trim();
    const cu = $('#inp-currency').value;

    if(!isValidUpi(pa)) { status('settings','Invalid UPI ID format'); return }
    if(!pn){ status('settings','Business/Payee name required'); return }

    localStorage.setItem(LS_KEY, JSON.stringify({pa,pn,tn,cu}));
    status('settings','Saved ✓');
  }

  function clearSettings(){
    localStorage.removeItem(LS_KEY);
    $('#inp-upi').value=''; $('#inp-name').value=''; $('#inp-note').value='';
    status('settings','Cleared');
  }

  function status(scope,msg){
    const id = scope==='settings' ? '#settings-status' : '#gen-status';
    const el = $(id); el.textContent = msg; setTimeout(()=>{ el.textContent=''; }, 3000)
  }

  function isValidUpi(pa){
    // Simple but practical UPI regex: user@handle, allows dots and digits
    return /^[a-zA-Z0-9.\-_]{2,256}@[a-zA-Z]{2,64}$/.test(pa)
  }

  function formatINR(n){
    try{ return new Intl.NumberFormat('en-IN',{style:'currency',currency:'INR',maximumFractionDigits:2}).format(Number(n)) }catch{ return '₹'+n }
  }

  function getSettings(){
    const raw = localStorage.getItem(LS_KEY);
    if(!raw) return null; try{ return JSON.parse(raw) }catch{ return null }
  }

  function makeLinks(){
    const s = getSettings();
    if(!s){ status('gen','Save settings first in Admin tab'); return }

    const customer = $('#inp-customer').value.trim();
    const amount = $('#inp-amount').value.trim();
    const tr = $('#inp-ref').value.trim();
    const noteInput = $('#inp-custom-note').value.trim();

    if(!customer){ status('gen','Customer name required'); return }
    const amt = Number(amount);
    if(!amt || amt <= 0){ status('gen','Enter a valid amount'); return }

    const tn = noteInput || s.tn || `Payment from ${customer}`;

    const params = new URLSearchParams();
    params.set('pa', s.pa);
    params.set('pn', s.pn);
    params.set('am', amt.toFixed(2));
    params.set('cu', s.cu || 'INR');
    if(tn) params.set('tn', tn);
    if(tr) params.set('tr', tr);

    // UPI deep link
    const upi = `upi://pay?${params.toString()}`;

    // Web link to this same file with customer-specific params for a nice landing page
    const base = location.href.split('?')[0].split('#')[0];
    const webParams = new URLSearchParams();
    webParams.set('name', customer);
    webParams.set('amount', amt.toFixed(2));
    webParams.set('pa', s.pa);
    webParams.set('pn', s.pn);
    if(tn) webParams.set('tn', tn);
    if(tr) webParams.set('tr', tr);
    const web = `${base}?${webParams.toString()}#pay`;

    // Output
    $('#out-upi').textContent = upi;
    $('#out-web').textContent = web;
    $('#btn-open-upi').href = upi;
    $('#btn-open-web').href = web;
    $('#results').classList.remove('hidden');
  }

  function copy(sel){
    const el = $(sel);
    const text = el.textContent || el.value || '';
    navigator.clipboard.writeText(text).then(()=>{
      const old = el.style.outline; el.style.outline = '2px solid var(--accent)';
      setTimeout(()=>{ el.style.outline=old }, 600)
    })
  }

  // CUSTOMER PAGE LOGIC – runs when query params are present
  function hydrateCustomerPage(){
    const url = new URL(location.href);
    const q = url.searchParams;
    if(!q.get('name') && !q.get('amount')) return; // nothing to preview

    switchTab('customer');

    const pa = q.get('pa') || (getSettings()?.pa || '');
    const pn = q.get('pn') || (getSettings()?.pn || '');
    const name = q.get('name') || '';
    const amount = q.get('amount') || '';
    const tn = q.get('tn') || (getSettings()?.tn || '');
    const tr = q.get('tr') || '';

    $('#cust-pn').textContent = pn || '—';
    $('#cust-pa').textContent = pa || '—';
    $('#cust-name').textContent = name || '—';
    $('#cust-amt').textContent = amount ? formatINR(amount) : '—';
    $('#cust-tn').textContent = tn || '—';
    $('#cust-tr').textContent = tr || '—';

    const params = new URLSearchParams();
    if(pa) params.set('pa', pa);
    if(pn) params.set('pn', pn);
    if(amount) params.set('am', Number(amount).toFixed(2));
    params.set('cu', 'INR');
    if(tn) params.set('tn', tn);
    if(tr) params.set('tr', tr);

    const upi = `upi://pay?${params.toString()}`;
    $('#cust-pay').href = upi;
    $('#cust-upi-link').textContent = upi;
  }

  // INIT
  loadSettings();
  hydrateCustomerPage();
</script>
</body>
</html>      border-radius: 5px;
      font-size: 1rem;
    }
    button {
      background: #007bff;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background: #0056b3;
    }
    .link-box {
      background: #f1f1f1;
      padding: 10px;
      border-radius: 5px;
      word-wrap: break-word;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>UPI Payment Dashboard</h1>

    <label for="upiId">Your UPI ID (saved)</label>
    <input type="text" id="upiId" placeholder="example@upi">

    <label for="name">Customer Name</label>
    <input type="text" id="name" placeholder="Enter customer name">

    <label for="amount">Amount (INR)</label>
    <input type="number" id="amount" placeholder="Enter amount">

    <button onclick="generateLink()">Generate Payment Link</button>

    <div id="output" style="display:none;">
      <label>Payment Link</label>
      <div class="link-box" id="paymentLink"></div>
      <button onclick="copyLink()">Copy to Clipboard</button>
    </div>
  </div>

  <script>
    // Save UPI ID in browser storage so you only enter it once
    const upiInput = document.getElementById('upiId');
    if(localStorage.getItem('upiId')){
      upiInput.value = localStorage.getItem('upiId');
    }

    function generateLink(){
      const upiId = document.getElementById('upiId').value.trim();
      const name = document.getElementById('name').value.trim();
      const amount = document.getElementById('amount').value.trim();

      if(!upiId || !name || !amount){
        alert('Please fill all fields');
        return;
      }

      // Save UPI ID locally
      localStorage.setItem('upiId', upiId);

      const url = `upi://pay?pa=${encodeURIComponent(upiId)}&pn=${encodeURIComponent(name)}&am=${encodeURIComponent(amount)}&cu=INR`;
      document.getElementById('paymentLink').innerText = url;
      document.getElementById('output').style.display = 'block';
    }

    function copyLink(){
      const link = document.getElementById('paymentLink').innerText;
      navigator.clipboard.writeText(link).then(() => {
        alert('Payment link copied to clipboard!');
      });
    }
  </script>
</body>
</html> 
